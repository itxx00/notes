"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[2891],{1435:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>h,frontMatter:()=>r,metadata:()=>a,toc:()=>c});var s=n(5893),o=n(3905);const r={layout:"post",title:"Ovirt\u4e2d\u7684stateless\u5b9e\u73b0\u673a\u5236\u5206\u6790",description:"\u7b80\u5355\u5206\u6790ovirt\u7684stateless\u5b9e\u73b0\u673a\u5236",categories:["virt","system"],tags:["ovirt","stateless"]},i=void 0,a={permalink:"/notes/blog/2013/03/14/ovirt-stateless",editUrl:"https://github.com/itxx00/notes/tree/main/blog/2013-03-14-ovirt-stateless.md",source:"@site/blog/2013-03-14-ovirt-stateless.md",title:"Ovirt\u4e2d\u7684stateless\u5b9e\u73b0\u673a\u5236\u5206\u6790",description:"\u7b80\u5355\u5206\u6790ovirt\u7684stateless\u5b9e\u73b0\u673a\u5236",date:"2013-03-14T00:00:00.000Z",formattedDate:"2013\u5e743\u670814\u65e5",tags:[{label:"ovirt",permalink:"/notes/blog/tags/ovirt"},{label:"stateless",permalink:"/notes/blog/tags/stateless"}],readingTime:9.385,hasTruncateMarker:!1,authors:[],frontMatter:{layout:"post",title:"Ovirt\u4e2d\u7684stateless\u5b9e\u73b0\u673a\u5236\u5206\u6790",description:"\u7b80\u5355\u5206\u6790ovirt\u7684stateless\u5b9e\u73b0\u673a\u5236",categories:["virt","system"],tags:["ovirt","stateless"]},unlisted:!1,prevItem:{title:"\u6b63\u786e\u4f7f\u7528shell\u8fd4\u56de\u503c",permalink:"/notes/blog/2013/05/17/bash-shell-exit-code"},nextItem:{title:"\u4f7f\u7528libvirt\u548ctc\u5b9e\u73b0vm\u5e26\u5bbd\u63a7\u5236",permalink:"/notes/blog/2013/03/01/libvirt-tc-bandwidth-control"}},l={authorsImageUrls:[]},c=[{value:"Ovirt\u7b80\u4ecb",id:"ovirt\u7b80\u4ecb",level:2},{value:"\u5173\u4e8estateless",id:"\u5173\u4e8estateless",level:2},{value:"\u5206\u6790\u5176\u5b9e\u73b0\u673a\u5236",id:"\u5206\u6790\u5176\u5b9e\u73b0\u673a\u5236",level:2},{value:"\u53c2\u8003\u6587\u6863",id:"\u53c2\u8003\u6587\u6863",level:2}];function d(e){const t={a:"a",blockquote:"blockquote",code:"code",h2:"h2",li:"li",p:"p",pre:"pre",ul:"ul",...(0,o.ah)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(t.blockquote,{children:["\n",(0,s.jsx)(t.p,{children:"\u6211\u53d1\u73b0ovirt\u7684node\u4e5f\u5c31\u662f\u8fd0\u884c\u865a\u62df\u673a\u7684\u4e3b\u673a\u88ab\u8bbe\u8ba1\u6210\u4e86\u8fd9\u6837\uff1a\u6574\u4e2a\u6839\u6587\u4ef6\u7cfb\u7edf\u662f\u53ea\u8bfb\u7684\uff0c\u53ea\u6709\u90e8\u5206\u914d\u7f6e\u6587\u4ef6\u88ab\u72ec\u7acb\u51fa\u6765\u653e\u5230\u4e86\u53e6\u5916\u7684\u5206\u533a\uff0c\u95ee\u4e86\u51e0\u4f4dIBM\u548c\u7ea2\u5e3d\u7684\u5de5\u7a0b\u5e08\uff0c\u660e\u767d\u4e86\u4e3a\u4ec0\u4e48\u9700\u8981\u8fd9\u79cdstateless\u4e5f\u5c31\u662f\u65e0\u72b6\u6001\u7684\u8bbe\u8ba1"}),"\n"]}),"\n",(0,s.jsx)(t.h2,{id:"ovirt\u7b80\u4ecb",children:"Ovirt\u7b80\u4ecb"}),"\n",(0,s.jsx)(t.p,{children:"\u8fd9\u662f\u6765\u81eacentos wiki\u4e2d\u7684\u63cf\u8ff0\uff1a"}),"\n",(0,s.jsxs)(t.blockquote,{children:["\n",(0,s.jsx)(t.p,{children:"oVirt \u662f\u4e2a\u7ba1\u7406\u865a\u62df\u5316\u7684\u5e94\u7528\u7a0b\u5e8f\u3002\u8a00\u4e0b\u4e4b\u610f\u5c31\u662f\u4f60\u53ef\u5229\u7528 oVirt \u7684\u7ba1\u7406\u754c\u9762\uff08oVirt \u5f15\u64ce\uff09\u6765\u7ba1\u7406\u786c\u4ef6\u8282\u70b9\u3001\u5b58\u50a8\u53ca\u7f51\u7edc\u8d44\u6e90\uff0c\u5e76\u90e8\u7f72\u53ca\u76d1\u63a7\u5728\u4f60\u7684\u6570\u636e\u4e2d\u5fc3\u5185\u8fd0\u884c\u7684\u865a\u62df\u673a\u5668\u3002\n\u5982\u679c\u4f60\u719f\u8bc6 VMware \u7684\u4ea7\u5668\uff0coVirt \u5728\u7406\u5ff5\u4e0a\u4e0e vSphere \u7c7b\u540c\u3002Red Hat \u4f01\u4e1a\u7ea7\u865a\u62df\u5316\u4ea7\u54c1\u4ee5 oVirt \u4f5c\u4e3a\u57fa\u7840\uff0c\u8fd9\u4e2a\u4e0a\u6e38\u8ba1\u5212\u5185\u5f00\u53d1\u7684\u65b0\u529f\u80fd\uff0c\u65e5\u540e\u4ea6\u4f1a\u5728\u83b7\u652f\u6301\u7684\u4ea7\u54c1\u5185\u51fa\u73b0\u3002"}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"ovirt\u662f\u4e00\u5957\u865a\u62df\u5316\u7ba1\u7406\u7684\u7cfb\u7edf\uff0c\u5176\u5bf9\u6807\u4ea7\u54c1\u662fvmware\u7684vsphere\uff0c\u5b83\u5206\u4e3aovirt-engine\u548covirt-node\uff0c\u53ef\u4ee5\u7528ovirt\u7684\u8fd9\u5957\u7cfb\u7edf\u6765\u7ba1\u7406\u865a\u62df\u673a\u7fa4\uff0c\u73b0\u5728\u865a\u62df\u5316\u76f8\u5173\u4ea7\u54c1\u4f17\u591a\uff0c\u5fae\u8f6f\uff0cvmware\uff0coracle\u7b49\u90fd\u5728\u505a\u8fd9\u65b9\u9762\u7684\u4ea7\u54c1\uff0c\u4e8e\u662fIBM\u7ea2\u5e3dubuntu\u7b49\u5382\u5546\u5c31\u8054\u5408\u8d77\u6765\u5f00\u59cb\u641e\u8fd9\u4e2a\u4e1c\u897f\u4e86\uff0c\u7ea2\u5e3d\u5f88\u65e9\u5c31\u5f00\u59cb\u6295\u5165kvm\u4e86\uff0c\u7ea2\u5e3d\u505a\u7684\u662fRHEV\u7684\u6574\u5957\u7cfb\u7edf\uff0c\u4e5f\u5206\u4e3anode\u548cengine\u53ea\u662f\u540d\u5b57\u4e0d\u4e00\u6837\uff0c\u540e\u6765\u5e72\u8106\u5c31\u628anode\u7684RHEV-H\u7ed9\u8d21\u732e\u51fa\u6765\uff0c\u5927\u5bb6\u4e00\u8d77\u641eovirt\u4e86\u3002\u524d\u51e0\u5929\u6211\u4e5f\u8bd5\u7528\u4e86\u4e00\u4e0bovirt\u548cRHEV\uff0c\u53d1\u73b0\u4ed6\u4eec\u7684node\u4e5f\u5c31\u662f\u8fd0\u884c\u865a\u62df\u673a\u7684\u4e3b\u673a\u88ab\u8bbe\u8ba1\u6210\u4e86\u8fd9\u6837: \u6574\u4e2a\u6839\u6587\u4ef6\u7cfb\u7edf\u662f\u53ea\u8bfb\u7684\uff0c\u53ea\u6709\u90e8\u5206\u914d\u7f6e\u6587\u4ef6\u88ab\u72ec\u7acb\u51fa\u6765\u653e\u5230\u4e86\u53e6\u5916\u7684\u5206\u533a\uff0c\u95ee\u4e86\u51e0\u4f4dIBM\u548c\u7ea2\u5e3d\u7684\u5de5\u7a0b\u5e08\uff0c\u624d\u77e5\u9053\u8fd9\u53ebstateless\uff0c\u65e0\u72b6\u6001\uff0c\u8fd9\u4e48\u505a\u7684\u597d\u5904\u662f\u8fd0\u884c\u73af\u5883\u548c\u5b58\u50a8\u5206\u79bb\uff0c\u63d0\u9ad8\u6574\u4f53\u53ef\u7528\u6027\u3002\u5728\u5206\u6790\u4e86ovirt\u4e2d\u7684stateless\u5b9e\u73b0\u673a\u5236\u4e4b\u540e\uff0c\u4e0b\u9762\u5c06\u5728centos6\u4e0a\u5c1d\u8bd5\u624b\u5de5\u914d\u7f6e\uff0c\u8fc7\u7a0b\u4e2d\u8bf7\u6559\u4e86\u51e0\u4f4dovirt\u7684\u5f00\u53d1,\u518d\u6b21\u8868\u793a\u611f\u8c22"}),"\n",(0,s.jsx)(t.h2,{id:"\u5173\u4e8estateless",children:"\u5173\u4e8estateless"}),"\n",(0,s.jsx)(t.p,{children:"\u8fd9\u79cdstateless\u7684\u8bbe\u8ba1\u6765\u81ea\u5f88\u65e9\u4e4b\u524d\u7ea2\u5e3d\u5728fedora\u91cc\u9762\u505a\u7684\u5c1d\u8bd5\uff0c\u76ee\u7684\u662f\u628a\u7cfb\u7edf\u505a\u6210liveCD\uff0c\u4e0b\u9762\u662f\u4e00\u4e9b\u5173\u4e8estateless\u7684\u63cf\u8ff0\uff1a"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:"read-only root file system(stateless linux)\nReadonly root support.\nThis was add to Fedora for Stateless Linux, i.e. for creating live Fedora CDs.\nHow to use:\n   * Edit `/etc/sysconfig/readonly-root`. Set 'READONLY' to 'yes'.\n   * Add any exceptions that need to be writable that aren't in the stock `/etc/rwtab` to an /etc/rwtab.d file. (See below)\nHow it works:\n   * On boot, we mount a tmpfs (by default, at /var/lib/stateless/writable), and then parse `/etc/rwtab` and `/etc/rwtab.d/*` for things to put there.\nThese files have the format:\n`<type>  <path>`\n\n* Types are as follows:\n  * empty: An empty path. Example:\n              `empty     /tmp`\n  * dirs: A directory tree that is copied, empty. Example:\n              `dirs      /var/run`\n  * files: A file or directory tree that is copied intact. Example:\n              `files     /etc/resolv.conf`\n\nA stock rwtab is shipped with common things that need mounted.\nWhen your computer comes back up, the root and any other system\npartitions will be mounted read-only. All the files and directories\nlisted in `/etc/rwtab` will be mounted read-write on a tmpfs filesystem.\nYou can add additional files and directories to rwtab to make them\nwritable after reboot.\n\nNote that this system is stateless. When you reboot again, everything\nwritten to the tmpfs filesystem vanishes and the system will be exactly\nas it was the last time it was booted. You could add a writable\nfilesystem on disk or NFS for writing files you want to retain after\nrebooting.\n\nTake a look at `/etc/rc.d/rc.sysinit` to see how the magic is done.\nThis capability is a \"technology preview\" (beta) and is buggy. Note that\n`/etc/mtab` and thus \"mount\" do not show the complete list of filesystems\nbecause the /etc directory is on a read-only filesystem. /proc/mounts\nalways shows the correct mount information. You could update `/etc/mtab`\nfrom /proc/mounts to correct it both after boot and after running the\nmount or umount commands to change mounts.\n\nRun `fgrep -v rootfs /proc/mounts >/etc/mtab` to correct `/etc/mtab`.\nNote that mounting or symlinking /proc/mounts to /etc/mtab causes other\nproblems such as breaking the df command.\n\nYou can change your read-only root filesystem to read-write mode\nimmediately with this command run by the root user:\n`mount -n -o remount,rw /`\n"})}),"\n",(0,s.jsx)(t.h2,{id:"\u5206\u6790\u5176\u5b9e\u73b0\u673a\u5236",children:"\u5206\u6790\u5176\u5b9e\u73b0\u673a\u5236"}),"\n",(0,s.jsx)(t.p,{children:"\u4e0b\u9762\u628a\u5206\u6790\u8fc7\u7a0b\u8bb0\u5f55\u4e0b\u6765\uff1a"}),"\n",(0,s.jsx)(t.p,{children:"\u9996\u5148\u6211\u770b\u5230\u7684\u662ffstab\u6587\u4ef6"}),"\n",(0,s.jsx)(t.p,{children:"/etc/fstab"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:"/dev/root / ext2 defaults,ro,noatime 0 0\ndevpts /dev/pts devpts gid=5,mode=620 0 0\ntmpfs /dev/shm tmpfs defaults 0 0\nproc /proc proc defaults 0 0\nsysfs /sys sysfs defaults 0 0\n/dev/HostVG/Config /config ext4 defaults,noauto,noatime 0 0\ndebugfs /sys/kernel/debug debugfs 0 0\n/dev/HostVG/Swap swap swap defaults 0 0\n/dev/HostVG/Logging /var/log ext4 defaults,noatime 0 0\n/dev/HostVG/Data /data ext4 defaults,noatime 0 0\n/data/images /var/lib/libvirt/images bind bind 0 0\n/data/core /var/log/core bind bind 0 0\n"})}),"\n",(0,s.jsx)(t.p,{children:"\u8fd9\u91cc\u8981\u6ce8\u610f\u7684\u5730\u65b9\u5c31\u662froot\u540e\u9762\u7684ro\uff0c\u4e5f\u5c31\u662f\u8bf4\u88ab\u6302\u8f7d\u6210\u4e86\u53ea\u8bfb\uff0c\u8fd9\u8bf4\u660estateless\u662f\u5728\u6302\u8f7d\u78c1\u76d8\u4e4b\u524d\u5c31\u5df2\u7ecf\u5b8c\u6210\uff0c\u90a3\u80af\u5b9a\u8ddf\u7cfb\u7edf\u542f\u52a8\u76f8\u5173\uff0c\n\u63a5\u7740\u6211\u4eec\u627e\u5230rc.sysinit\u8fd9\u4e2a\u5728\u7cfb\u7edf\u542f\u52a8\u9636\u6bb5\u6267\u884c\u7684\u811a\u672c\u4e2d\u4e0b\u9762\u8fd9\u6bb5\u5185\u5bb9:"}),"\n",(0,s.jsx)(t.p,{children:"/etc/rc.d/rc.sysinit"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:'for file in /etc/statetab /etc/statetab.d/* ; do\n    is_ignored_file "$file" && continue\n    [ ! -f "$file" ] && continue\n\n    if [ -f "$STATE_MOUNT/$file" ] ; then\n        mount -n --bind "$STATE_MOUNT/$file" "$file"\n    fi\n\n    for path in $(grep -v "^#" "$file" 2>/dev/null); do\n        mount_state "$path"\n        [ -n "$SELINUX_STATE" -a -e "$path" ] && restorecon -R "$path"\n    done\ndone\n'})}),"\n",(0,s.jsx)(t.p,{children:"\u8fd9\u6bb5shell\u91cc\u9762\u7275\u626f\u5230\u4e86\u4e2a/etc/statetab,\u800c\u4e14\u901a\u8fc7\u5bf9\u6bd4\u666e\u901a\u7cfb\u7edf\u8fd8\u53d1\u73b0\u5176\u4ed6\u5730\u65b9\u7684\u4e0d\u540c"}),"\n",(0,s.jsx)(t.p,{children:"diff rc.sysinit /etc/rc.sysinit"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:'102a103,108\n> elif [[ "$system_release" =~ "CentOS" ]]; then\n> [ "$BOOTUP" = "color" ] && echo -en "\\\\033[0;36m"\n> echo -en "CentOS"\n> [ "$BOOTUP" = "color" ] && echo -en "\\\\033[0;39m"\n> PRODUCT=$(sed "s/CentOS \\(.*\\) \\?release.*/\\1/" /etc/system-release)\n> echo " $PRODUCT"\n499c505\n< action $"Mounting local filesystems: " mount -a -t nonfs,nfs4,smbfs,ncpfs,cifs,gfs,gfs2,noproc,nosysfs,nodevpts -O no_netdev\n---\n> action $"Mounting local filesystems: " mount -a -t nonfs,nfs4,smbfs,ncpfs,cifs,gfs,gfs2 -O no_netdev\n501c507\n< action $"Mounting local filesystems: " mount -a -n -t nonfs,nfs4,smbfs,ncpfs,cifs,gfs,gfs2,noproc,nosysfs,nodevpts -O no_netdev\n---\n> action $"Mounting local filesystems: " mount -a -n -t nonfs,nfs4,smbfs,ncpfs,cifs,gfs,gfs2 -O no_netdev\n'})}),"\n",(0,s.jsx)(t.p,{children:"\u63a5\u7740\u770b\u770b\u8fd9\u4e2a/etc/statetab\u6587\u4ef6\u662f\u4e2a\u4ec0\u4e48\u6837\u5b50\u7684\uff1a"}),"\n",(0,s.jsx)(t.p,{children:"/etc/statetab"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:"# A list of paths which should be bind-mounted from a\n# partition dedicated to persistent data\n#\n# See $STATE_LABEL in /etc/sysconfig/readonly-root\n#\n# Examples:\n#\n# /root\n# /etc/ssh\n# /var/spool/mail\n"})}),"\n",(0,s.jsx)(t.p,{children:"\u987a\u85e4\u6478\u74dc\u6211\u4eec\u53d1\u73b0\u548c/etc/sysconfig/readonly-root\u8fd9\u4e2a\u6587\u4ef6\u6709\u5173\uff0c\u4ece\u6587\u4ef6\u540d\u4e0a\u5373\u53ef\u5f97\u77e5\u548c\u53ea\u8bfb\u7684\u5173\u8054\uff1a"}),"\n",(0,s.jsx)(t.p,{children:"/etc/sysconfig/readonly-root"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:"Set to 'yes' to mount the system filesystems read-only.\nREADONLY=yes\n# Set to 'yes' to mount various temporary state as either tmpfs\n# or on the block device labelled RW_LABEL. Implied by READONLY\nTEMPORARY_STATE=no\n# Place to put a tmpfs for temporary scratch writable space\nRW_MOUNT=/var/lib/stateless/writable\n# Label on local filesystem which can be used for temporary scratch space\nRW_LABEL=stateless-rw\n# Options to use for temporary mount\nRW_OPTIONS=\n# Label for partition with persistent data\nSTATE_LABEL=CONFIG \n# Where to mount to the persistent data\nSTATE_MOUNT=/config\n# Options to use for peristent mount\nSTATE_OPTIONS=\n# NFS server to use for persistent data?\nCLIENTSTATE=\n"})}),"\n",(0,s.jsx)(t.p,{children:"\u5c31\u662f\u8fd9\u4e2a\u4e86\uff0c\u9996\u5148\u5b83\u628aREADONLY\u8bbe\u7f6e\u4e3ayes\uff0c\u7136\u540e\u4f7f\u7528\u8bbe\u5907\u7684LABEL\u53f7\u6765\u6307\u5b9a\u9700\u8981\u6302\u8f7d\u4e3a\u8bfb\u5199\u7684\u8bbe\u5907\uff0c\u7136\u540e\u5c31\u662f\u6302\u8f7d\u7684\u4f4d\u7f6eSTATE_MOUNT"}),"\n",(0,s.jsx)(t.p,{children:"\u540c\u65f6\u8fd8\u6709/etc/rwtab\u4ee5\u53carwtab.d\u76ee\u5f55\u4e0e\u8fd9\u4e2a\u6709\u5173\uff1a\n/etc/rwtab"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:"#files /etc/adjtime\n#files /etc/ntp.conf\n#files /etc/resolv.conf\n#files /etc/lvm/.cache\n#files /etc/lvm/archive\n#files /etc/lvm/backup\n"})}),"\n",(0,s.jsx)(t.p,{children:"\u4e0a\u9762\u8fd9\u51e0\u9879\u5728ovirt-node\u91cc\u662f\u88ab\u6ce8\u91ca\u6389\u4e86\u7684\uff0c\u5b83\u4f7f\u7528\u81ea\u5df1\u7684\u65b9\u5f0f\u6765\u53d8\u66f4\u8fd9\u51e0\u4e2a\u6587\u4ef6"}),"\n",(0,s.jsx)(t.p,{children:"/etc/rwtab.d/ovirt"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:"files /etc\ndirs /var/lib/multipath\ndirs /var/lib/net-snmp\ndirs /var/lib/dnsmasq\nfiles /root/.ssh\ndirs /root/.uml\ndirs /root/.virt-manager\ndirs /home/admin/.virt-manager\nfiles /var/cache/libvirt\nfiles /var/empty/sshd/etc/localtime\nfiles /var/lib/libvirt\nfiles /var/lib/multipath\nfiles /var/cache/multipathd\nempty /mnt\nempty /live\nfiles /boot\nempty /boot-kdump\nempty /cgroup\n"})}),"\n",(0,s.jsx)(t.p,{children:"\u4e0a\u9762\u8fd9\u4e9b\u662fovirt\u81ea\u5b9a\u4e49\u7684\u3002\u6700\u540e\u5c31\u662f\u770b/config\u4e0b\u9762\u7684files\u6587\u4ef6:"}),"\n",(0,s.jsx)(t.p,{children:"/config/files"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:"/etc/fstab\n/etc/shadow\n/etc/default/ovirt\n/etc/ssh/ssh_host_key\n/etc/ssh/ssh_host_key.pub\n/etc/ssh/ssh_host_dsa_key\n/etc/ssh/ssh_host_dsa_key.pub\n/etc/ssh/ssh_host_rsa_key\n/etc/ssh/ssh_host_rsa_key.pub\n/etc/iscsi/initiatorname.iscsi\n/etc/sysconfig/network-scripts/ifcfg-eth0\n/etc/sysconfig/network-scripts/ifcfg-breth0\n/etc/sysconfig/network-scripts/ifcfg-eth1\n/etc/ntp.conf\n/etc/sysconfig/network\n/etc/hosts\n/etc/shadow\n/etc/ssh/sshd_config\n"})}),"\n",(0,s.jsx)(t.p,{children:"\u6b64\u5217\u8868\u5185\u7684\u6587\u4ef6\u5c31\u662frc.sysinit\u9700\u8981\u8bfb\u53d6\u7684\uff0c\u628a\u4ed6\u4eec\u4e00\u4e2a\u4e2a\u6302\u8f7d\u4e3a\u8bfb\u5199\uff0c\u8fd9\u6837\u5c31\u5b9e\u73b0\u4e86\u53ef\u4fee\u6539\u914d\u7f6e\u6587\u4ef6\u767d\u540d\u5355\uff0c\u4e8e\u662f\u6211\u5c31\u52a8\u624b\u4fee\u6539\u4e86\u7cfb\u7edf\u91cc\u7684\u8fd9\u4e9b\u6587\u4ef6\uff0c\u91cd\u542f\uff0c\u4e00\u5207\u770b\u4f3c\u6b63\u5e38\uff0c\u4f46\u662f\u5f53\u5173\u673a\u7684\u65f6\u5019\u65b0\u7684\u95ee\u9898\u51fa\u73b0\u4e86\uff0c\u5173\u673a\u7684\u65f6\u5019\u63d0\u793a/etc\u65e0\u6cd5\u88ab\u5378\u8f7d\uff0c\u4e3a\u4ec0\u4e48\u5462\uff0c\u7136\u540e\u5c31\u627e\u5230\u4e0e\u5173\u673a\u6709\u5173\u7684\u811a\u672c\uff1a"}),"\n",(0,s.jsx)(t.p,{children:"diff /etc/rc.d/init.d/halt.orig /etc/rc.d/init.d/halt"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:"141c141\n< LANG=C __umount_loop '$2 ~ /^\\/$|^\\/proc|^\\/dev/{next}\n---\n> LANG=C __umount_loop '$2 ~ /^\\/$|^\\/proc|^\\/etc|^\\/dev/{next}\n"})}),"\n",(0,s.jsx)(t.p,{children:"\u539f\u6765\u5728halt\u6587\u4ef6\u91cc\u4e5f\u505a\u4e86\u201c\u624b\u811a\u201d\uff0c\u628a/etc\u7ed9\u52a0\u4e86\u8fdb\u53bb\uff0c\u91cd\u542f\uff0c\u4fee\u6539\uff0c\u5173\u673a\uff0c\u4e00\u5207\u6b63\u5e38\u3002"}),"\n",(0,s.jsx)(t.h2,{id:"\u53c2\u8003\u6587\u6863",children:"\u53c2\u8003\u6587\u6863"}),"\n",(0,s.jsx)(t.p,{children:"\u4e0b\u9762\u662f\u53ef\u4ee5\u53c2\u8003\u7684\u6587\u6863"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.a,{href:"http://fedoraproject.org/wiki/StatelessLinux/PrepareImage",children:"http://fedoraproject.org/wiki/StatelessLinux/PrepareImage"})}),"\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.a,{href:"http://fedoraproject.org/wiki/StatelessLinux/HOWTO",children:"http://fedoraproject.org/wiki/StatelessLinux/HOWTO"})}),"\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.a,{href:"http://blog.csdn.net/jcwkyl/article/details/6120547",children:"http://blog.csdn.net/jcwkyl/article/details/6120547"})}),"\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.a,{href:"http://plone.lucidsolutions.co.nz/linux/io/using-centos-5.2-stateless-linux-support-on-a-flash-based-root-filesystem",children:"http://plone.lucidsolutions.co.nz/linux/io/using-centos-5.2-stateless-linux-support-on-a-flash-based-root-filesystem"})}),"\n",(0,s.jsxs)(t.li,{children:["FYI: ",(0,s.jsx)(t.a,{href:"http://ovirt.org/wiki/File:Ovirt-node.pdf",children:"http://ovirt.org/wiki/File:Ovirt-node.pdf"})," (page 26)"]}),"\n"]})]})}function h(e={}){const{wrapper:t}={...(0,o.ah)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},3905:(e,t,n)=>{n.d(t,{ah:()=>c});var s=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function a(e,t){if(null==e)return{};var n,s,o=function(e,t){if(null==e)return{};var n,s,o={},r=Object.keys(e);for(s=0;s<r.length;s++)n=r[s],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(s=0;s<r.length;s++)n=r[s],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var l=s.createContext({}),c=function(e){var t=s.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},d={inlineCode:"code",wrapper:function(e){var t=e.children;return s.createElement(s.Fragment,{},t)}},h=s.forwardRef((function(e,t){var n=e.components,o=e.mdxType,r=e.originalType,l=e.parentName,h=a(e,["components","mdxType","originalType","parentName"]),p=c(n),f=o,m=p["".concat(l,".").concat(f)]||p[f]||d[f]||r;return n?s.createElement(m,i(i({ref:t},h),{},{components:n})):s.createElement(m,i({ref:t},h))}));h.displayName="MDXCreateElement"}}]);